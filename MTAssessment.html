<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Server Multitenancy Assessment Tool</title>
    <style>
        /* Base styles */
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Typography */
        h1 {
            color: #2c3e50;
            margin-bottom: 30px;
            text-align: center;
            line-height: 1.2;
        }

        h2 {
            font-size: 0.9em;
            font-weight: normal;
            color: #666;
            margin-bottom: 5px;
        }

        h3 {
            font-size: 0.9em;
            font-weight: normal;
            color: #666;
            margin-bottom: 15px;
        }

        /* Questions */
        .question-container {
            margin-bottom: 30px;
            padding: 0 0 20px;
            border-bottom: 1px solid #eee;
        }

        .question-container:last-child {
            border-bottom: none;
        }

        .question p {
            font-size: 1.2em;
            color: #34495e;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .question-info {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #f8f9fa;
            border-left: 4px solid #3498db;
        }

        /* Options */
        .options {
            display: flex;
            gap: 20px;
            margin-bottom: 0;
            margin-top: 30px;
            align-items: center;
            justify-content: flex-start;
        }

        .option {
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            min-width: 80px;
            text-align: center;
            background-color: #fff;
            border: 2px solid;
        }

        .option[onclick*="true"] {
            color: #28a745;
            border-color: #28a745;
        }

        .option[onclick*="false"] {
            color: #dc3545;
            border-color: #dc3545;
        }

        .option[onclick*="'unknown'"] {
            color: #6c757d;
            border-color: #6c757d;
        }

        .option[onclick*="true"]:hover, .option[onclick*="true"].selected {
            background-color: #28a745;
            color: white;
        }

        .option[onclick*="false"]:hover, .option[onclick*="false"].selected {
            background-color: #dc3545;
            color: white;
        }

        .option[onclick*="'unknown'"]:hover, .option[onclick*="'unknown'"].selected {
            background-color: #6c757d;
            color: white;
        }

        /* Results */
        .result {
            margin-top: 30px;
            padding: 20px;
            border-radius: 5px;
            display: none;
        }

        .result.eligible {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .result.not-eligible {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .result.warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }

        /* Navigation */
        .nav-buttons-container {
            margin-top: 25px;
            display: flex;
            gap: 10px;
            justify-content: flex-start;
        }

        .nav-button {
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .nav-button .arrow {
            font-size: 0.8em;
            line-height: 1;
        }

        .nav-button:hover {
            background-color: #2980b9;
        }

        /* Summary section */
        .summary-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            display: none;
        }

        .summary-title {
            font-size: 1.4em;
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }

        .summary-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 2px solid #dee2e6;
        }

        .summary-tab {
            padding: 10px 20px;
            cursor: pointer;
            font-weight: bold;
            color: #6c757d;
            border: none;
            background: none;
            margin-right: 5px;
            border-bottom: 2px solid transparent;
            margin-bottom: -2px;
        }

        .summary-tab.active {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
        }

        .summary-tab:hover {
            color: #2c3e50;
        }

        .summary-view {
            display: none;
        }

        .summary-view.active {
            display: block;
        }

        /* Tables */
        .summary-table, .spreadsheet-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .summary-table th,
        .summary-table td,
        .spreadsheet-table th,
        .spreadsheet-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .summary-table th,
        .spreadsheet-table th {
            background-color: #f8f9fa;
            font-weight: bold;
            color: #2c3e50;
        }

        .summary-table tr:hover,
        .spreadsheet-table tr:hover {
            background-color: #f8f9fa;
        }

        /* Project info */
        .project-info {
            background-color: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
            border: 1px solid #dee2e6;
        }

        .info-row {
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .info-field {
            flex: 1;
        }

        .info-field:first-child {
            flex: 0.3;  /* Make the first field (Project ID) 70% narrower */
        }

        .info-field:last-child {
            flex: 0.8;  /* Make the last field (Application) 20% smaller */
            margin-right: 0%;  /* Remove the right margin to extend the field */
        }

        .info-field label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: bold;
        }

        .info-input {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #3498db;
            border-radius: 4px;
            font-size: 1em;
            color: #2c3e50;
            transition: all 0.3s ease;
            box-sizing: border-box;
        }

        .info-input:focus {
            outline: none;
            border-color: #2980b9;
            box-shadow: 0 0 5px rgba(41, 128, 185, 0.3);
        }

        .info-input::placeholder {
            color: #95a5a6;
        }

        /* Utility classes */
        .hidden {
            display: none;
        }

        .error-message {
            color: #dc3545;
            font-size: 0.8em;
            margin-top: 5px;
            display: none;
        }

        .info-input.error {
            border-color: #dc3545;
        }

        /* Spreadsheet controls */
        .spreadsheet-controls {
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .copy-button {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 16px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s ease;
        }

        .copy-button:hover {
            background-color: #2980b9;
        }

        .copy-message {
            color: #28a745;
            font-size: 0.9em;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .copy-message.show {
            opacity: 1;
        }

        /* Latency select */
        .latency-select {
            width: 50%;
            padding: 12px;
            margin: 20px 0;
            border: 2px solid #3498db;
            border-radius: 5px;
            font-size: 1em;
            color: #2c3e50;
            background-color: white;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-left: 0;
        }

        .latency-select:hover {
            border-color: #2980b9;
        }

        .latency-select:focus {
            outline: none;
            border-color: #2980b9;
            box-shadow: 0 0 5px rgba(41, 128, 185, 0.3);
        }

        .latency-select option {
            padding: 10px;
        }

        /* Summary navigation */
        .summary-nav {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            justify-content: center;
            align-items: center;
        }

        .summary-nav-button {
            padding: 10px 20px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .summary-nav-button:hover {
            background-color: #2980b9;
        }

        .question-select {
            padding: 8px;
            border: 2px solid #3498db;
            border-radius: 5px;
            font-size: 1em;
            color: #2c3e50;
            background-color: white;
            cursor: pointer;
            min-width: 200px;
        }

        .question-select:hover {
            border-color: #2980b9;
        }

        .question-select:focus {
            outline: none;
            border-color: #2980b9;
            box-shadow: 0 0 5px rgba(41, 128, 185, 0.3);
        }
    </style>
</head>
<body>
    <div class="container" role="main">
        <h1>SQL Server<br>Multi-Tenant Assessment</h1>
        
        <!-- Project Information -->
        <div class="project-info" role="form">
            <div class="info-row">
                <div class="info-field">
                    <label for="projectId">Project ID:</label>
                    <div class="input-group" style="display: flex; align-items: stretch;">
                        <span style="background-color: white; padding: 8px 12px; border: 1px solid #3498db; border-right: none; border-radius: 4px 0 0 4px; color: #2c3e50; font-size: 1em; display: flex; align-items: center;">PRJ</span>
                        <input type="text" id="projectId" class="info-input" placeholder="Enter Project ID" style="border: 1px solid #3498db; border-radius: 0 4px 4px 0; padding: 8px; font-size: 1em; color: #95a5a6;"
                               aria-label="Project ID">
                    </div>
                </div>
                <div class="info-field">
                    <label for="application">Application:</label>
                    <div class="input-group" style="display: flex; align-items: stretch;">
                        <span style="background-color: white; padding: 8px 12px; border: 1px solid #3498db; border-right: none; border-radius: 4px 0 0 4px; color: #2c3e50; font-size: 1em; display: flex; align-items: center;">APP</span>
                        <input type="text" id="application" class="info-input" placeholder="Enter Application Name" style="border: 1px solid #3498db; border-radius: 0 4px 4px 0; padding: 8px; font-size: 1em; color: #95a5a6;"
                               aria-label="Application Name">
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Questions start here -->
        <div id="question1" class="question-container" role="region" aria-label="Question 1">
            <div class="question">
                <h2>Question 1 of 10</h2>
                <h3>Application Architecture</h3>

                <p>Is this an all-in-one (AIO) application?</p>
                <div class="explanation-box">
                    <div class="explanation-label">Explanation:</div>
                    <div class="explanation-text">None</div>
                </div>
                <div class="options" role="radiogroup" aria-label="Answer options for question 1">
                    <button class="option" onclick="handleAnswer(1, true)" role="radio" aria-checked="false" tabindex="0">Yes</button>
                    <button class="option" onclick="handleAnswer(1, false)" role="radio" aria-checked="false" tabindex="0">No</button>
                    <button class="option" onclick="handleAnswer(1, 'unknown')" role="radio" aria-checked="false" tabindex="0">Unknown</button>
                </div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton1" class="nav-button" onclick="showPreviousQuestion()" aria-label="Previous question"><span class="arrow">←</span> Previous</button>
                <button id="nextButton1" class="nav-button" onclick="showNextQuestion()" aria-label="Next question">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton1" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Architecture Question 2 (formerly Q3) -->
        <div id="question2" class="question-container hidden">
            <div class="question-number">Question 2 of 10</div>
            <div class="question-category">Architecture Requirements</div>
            <div class="question">
                <h2>Question 2 of 10</h2>
                <h3>SQL Server Installation</h3>

                <p>Is SQL Server tied to vendor installation?</p>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">None</div>
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 2">
                <div class="option yes" onclick="handleAnswer(2, true)">Yes</div>
                <div class="option no" onclick="handleAnswer(2, false)">No</div>
                <div class="option unknown" onclick="handleAnswer(2, 'unknown')">Unknown</div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton2" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton2" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton2" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Storage Question 3 (formerly Q2) -->
        <div id="question3" class="question-container hidden">
            <div class="question-number">Question 3 of 10</div>
            <div class="question-category">Storage Requirements</div>
            <div class="question">
                <h2>Question 3 of 10</h2>
                <h3>Storage Requirements</h3>

                <p>Will the total size of the database(s) exceed 100GB in the next 3-5 years?</p>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">None</div>
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 3">
                <div class="option yes" onclick="handleAnswer(3, true)">Yes</div>
                <div class="option no" onclick="handleAnswer(3, false)">No</div>
                <div class="option unknown" onclick="handleAnswer(3, 'unknown')">Unknown</div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton3" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton3" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton3" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Storage Question 4 (formerly Q4) -->
        <div id="question4" class="question-container hidden">
            <div class="question-number">Question 4 of 10</div>
            <div class="question-category">Storage Requirements</div>
            <div class="question">
                <h2>Question 4 of 10</h2>
                <h3>Database Naming</h3>

                <p>Can databases be renamed if needed?</p>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">In order to avoid duplicate database names on the multi-tenant instance, or to help identify/distinguish the database.</div>
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 4">
                <div class="option yes" onclick="handleAnswer(4, true)">Yes</div>
                <div class="option no" onclick="handleAnswer(4, false)">No</div>
                <div class="option unknown" onclick="handleAnswer(4, 'unknown')">Unknown</div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton4" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton4" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton4" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Network Question 5 (formerly Q6) -->
        <div id="question5" class="question-container hidden">
            <div class="question">
                <h2>Question 5 of 10</h2>
                <h3>Network Requirements</h3>

                <p>What is the required network latency between application and database?</p>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">Defines the maximum acceptable delay in communication between the application and the database server. Lower latency requirements may necessitate dedicated resources or optimized network configurations, impacting the feasibility of a multi-tenant environment.</div>
            </div>
            <div class="options">
                <select id="latencySelect" class="latency-select" onchange="handleLatencyAnswer(this.value)" aria-label="Select latency requirement">
                    <option value="">Select latency requirement...</option>
                    <option value="unknown">Unknown</option>
                    <option value="very-low">1-10 ms (Very Low)</option>
                    <option value="low">10-50ms (Low)</option>
                    <option value="moderate">50-100ms (Moderate)</option>
                    <option value="high">100-500ms (High)</option>
                    <option value="very-high">>500ms (Very High)</option>
                </select>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton5" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton5" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton5" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Network Question 6 (formerly Q7) -->
        <div id="question6" class="question-container hidden">
            <div class="question-number">Question 6 of 10</div>
            <div class="question-category">Network & Performance Requirements</div>
            <div class="question">
                <h2>Question 6 of 10</h2>
                <h3>Database Interaction</h3>

                <p>How would you characterize the application's database interaction frequency?</p>
            </div>
            <div class="question-info">
                Measures the volume and frequency of database interactions. A highly chatty application sends frequent queries or transactions to the database server, which can impact performance, resource allocation, and suitability for a multi-tenant environment.
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 7">
                <select id="chattinessSelect" class="latency-select" onchange="handleChattinessAnswer(this.value)" aria-label="Select application chattiness level">
                    <option value="">Select application chattiness level...</option>
                    <option value="unknown">Unknown</option>
                    <option value="low">Low (Infrequent database calls)</option>
                    <option value="moderate">Moderate (Regular database interactions)</option>
                    <option value="high">High (Very frequent database calls)</option>
                </select>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton6" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton6" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton6" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Configuration Question 7 (formerly Q5) -->
        <div id="question7" class="question-container hidden">
            <div class="question-number">Question 7 of 10</div>
            <div class="question-category">Configuration Requirements</div>
            <div class="question">
                <h2>Question 7 of 10</h2>
                <h3>Time Zone Requirements</h3>

                <p>Can the database be in a different time zone than the app server?</p>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">None</div>
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 7">
                <div class="option yes" onclick="handleAnswer(7, true)">Yes</div>
                <div class="option no" onclick="handleAnswer(7, false)">No</div>
                <div class="option unknown" onclick="handleAnswer(7, 'unknown')">Unknown</div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton7" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton7" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton7" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Security Question 8 -->
        <div id="question8" class="question-container hidden">
            <div class="question-number">Question 8 of 10</div>
            <div class="question-category">Security Requirements</div>
            <div class="question">
                <h2>Question 8 of 10</h2>
                <h3>Server Privileges</h3>

                <p>Are administrative privileges on the server required?</p>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">Do any accounts need to belong to the Windows 'Administrators' group?</div>
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 8">
                <div class="option yes" onclick="handleAnswer(8, true)">Yes</div>
                <div class="option no" onclick="handleAnswer(8, false)">No</div>
                <div class="option unknown" onclick="handleAnswer(8, 'unknown')">Unknown</div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton8" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton8" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton8" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Security Question 9 -->
        <div id="question9" class="question-container hidden">
            <div class="question-number">Question 9 of 10</div>
            <div class="question-category">Security Requirements</div>
            <div class="question">
                <h2>Question 9 of 10</h2>
                <h3>SQL Server Privileges</h3>

                <p>Are permanent administrative privileges on the SQL Server instance required?</p>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">Permanent administrative privileges include fixed server roles such as: sysadmin, serveradmin, securityadmin, processadmin, setupadmin, bulkadmin, diskadmin, dbcreator. Requiring these permanently is a disqualifier for multitenancy.</div>
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 9">
                <div class="option yes" onclick="handleAnswer(9, true)">Yes</div>
                <div class="option no" onclick="handleAnswer(9, false)">No</div>
                <div class="option unknown" onclick="handleAnswer(9, 'unknown')">Unknown</div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton9" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton9" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton9" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Components Question 10 -->
        <div id="question10" class="question-container hidden">
            <div class="question-number">Question 10 of 10</div>
            <div class="question-category">Components Requirements</div>
            <div class="question">
                <h2>Question 10 of 10</h2>
                <h3>Additional Components</h3>

                <p>Are any of the following components required for this application?</p>
                <ul>
                    <li>SQL Server Reporting Services (SSRS)</li>
                    <li>SQL Server Integration Services (SSIS)</li>
                    <li>SQL Server Analysis Services (SSAS)</li>
                </ul>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">
                    SSRS - SQL Server Reporting Services<br>
                    SSIS - SQL Server Integration Services<br>
                    SSAS - SQL Server Analysis Services
                </div>
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 10">
                <div class="option yes" onclick="handleAnswer(10, true)">Yes</div>
                <div class="option no" onclick="handleAnswer(10, false)">No</div>
                <div class="option unknown" onclick="handleAnswer(10, 'unknown')">Unknown</div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton10" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton10" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton10" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Components Question 11 (Conditional) -->
        <div id="question11" class="question-container hidden">
            <div class="question-number">Question 11 of 11</div>
            <div class="question-category">Components Requirements</div>
            <div class="question">
                <h2>Question 11</h2>
                <h3>Component Location</h3>

                <p>Must these components be on the same server as SQL Server?</p>
            </div>
            <div class="explanation-box">
                <div class="explanation-label">Explanation:</div>
                <div class="explanation-text">This determines if SQL Server components like SSRS, SSIS, or SSAS must be co-located with the database engine.</div>
            </div>
            <div class="options" role="radiogroup" aria-label="Answer options for question 11">
                <div class="option yes" onclick="handleAnswer(11, true)">Yes</div>
                <div class="option no" onclick="handleAnswer(11, false)">No</div>
                <div class="option unknown" onclick="handleAnswer(11, 'unknown')">Unknown</div>
            </div>
            <div class="nav-buttons-container">
                <button id="prevButton11" class="nav-button" onclick="showPreviousQuestion()"><span class="arrow">←</span> Previous</button>
                <button id="nextButton11" class="nav-button" onclick="showNextQuestion()">Next <span class="arrow">→</span></button>
                <button id="showSummaryButton11" class="nav-button" onclick="showSummary()">Show Summary</button>
            </div>
        </div>

        <!-- Summary Section -->
        <div id="summary" class="summary-section">
            <div class="summary-title">Assessment Summary</div>
            <div class="summary-tabs">
                <button class="summary-tab active" onclick="switchSummaryView('detailed')">Detailed View</button>
                <button class="summary-tab" onclick="switchSummaryView('table')">Table View</button>
                <button class="summary-tab" onclick="switchSummaryView('spreadsheet')">Spreadsheet View</button>
            </div>
            <div id="detailed-view" class="summary-view active">
                <div id="summary-content"></div>
            </div>
            <div id="table-view" class="summary-view">
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Question</th>
                            <th>Status</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody id="summary-table-content"></tbody>
                </table>
            </div>
            <div id="spreadsheet-view" class="summary-view">
                <div class="spreadsheet-controls">
                    <button id="copySpreadsheetButton" class="copy-button" onclick="copySpreadsheetData()">
                        <span class="copy-icon">📋</span> Copy to Clipboard
                    </button>
                    <span id="copyMessage" class="copy-message"></span>
                </div>
                <div class="spreadsheet-container">
                    <table id="spreadsheet-table" class="spreadsheet-table">
                        <thead>
                            <tr>
                                <th>Question Number</th>
                                <th>Category</th>
                                <th>Question</th>
                                <th>Answer</th>
                                <th>Status</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="spreadsheet-content"></tbody>
                    </table>
                </div>
            </div>
            <div id="final-result" class="final-result"></div>
            <div class="summary-nav">
                <select id="questionSelect" class="question-select" aria-label="Go to question">
                    <option value="">Go to question...</option>
                </select>
                <button class="summary-nav-button previous" onclick="showPreviousFromSummary()">Previous</button>
                <button class="summary-nav-button start-over" onclick="startOver()">Start Over</button>
            </div>
        </div>

        <div id="result" class="result"></div>
    </div>

    <script>
        // Cache DOM elements
        const DOM = {
            container: document.querySelector('.container'),
            projectId: document.getElementById('projectId'),
            application: document.getElementById('application'),
            projectIdError: document.getElementById('projectIdError'),
            applicationError: document.getElementById('applicationError'),
            result: document.getElementById('result'),
            summary: document.getElementById('summary'),
            summaryContent: document.getElementById('summary-content'),
            finalResult: document.getElementById('final-result'),
            tableContent: document.getElementById('summary-table-content'),
            spreadsheetContent: document.getElementById('spreadsheet-content'),
            latencySelect: document.getElementById('latencySelect'),
            chattinessSelect: document.getElementById('chattinessSelect')
        };

        let currentQuestion = 1;
        const totalQuestions = 11;
        const answers = {};
        
        // Define which category each question belongs to
        const questionToCategory = {
            1: 'architecture',
            2: 'architecture',
            3: 'storage',
            4: 'storage',
            5: 'network',
            6: 'network',
            7: 'configuration',
            8: 'security',
            9: 'security',
            10: 'components',
            11: 'components'
        };

        // Cache category sections
        const categorySections = document.querySelectorAll('.category-section');
        const questionContainers = document.querySelectorAll('.question-container');
        const options = document.querySelectorAll('.option');

        function updateCategoryVisibility(questionNumber) {
            // Remove this function as categories are no longer shown
            return;
        }

        function showQuestion(questionNumber) {
            // Hide summary if showing questions again
            DOM.summary.style.display = 'none';
            
            // Hide the result div when changing questions
            DOM.result.style.display = 'none';
            
            // Hide all questions
            questionContainers.forEach(container => {
                container.classList.add('hidden');
            });
            
            // Show current question
            const currentQuestionElement = document.getElementById(`question${questionNumber}`);
            if (currentQuestionElement) {
                currentQuestionElement.classList.remove('hidden');
                
                // Clear all selected states first
                currentQuestionElement.querySelectorAll('.option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                // Restore selected state if there's an answer
                if (answers[questionNumber] !== undefined) {
                    if (questionNumber === 5) {
                        // Handle latency dropdown
                        if (DOM.latencySelect) {
                            DOM.latencySelect.value = answers[questionNumber].level;
                        }
                    } else if (questionNumber === 6) {
                        // Handle chattiness dropdown
                        if (DOM.chattinessSelect) {
                            DOM.chattinessSelect.value = answers[questionNumber].level;
                        }
                    } else {
                        // Handle Yes/No/Unknown options
                        let selectedClass;
                        if (answers[questionNumber] === true) {
                            selectedClass = 'yes';
                        } else if (answers[questionNumber] === false) {
                            selectedClass = 'no';
                        } else if (answers[questionNumber] === 'unknown') {
                            selectedClass = 'unknown';
                        }
                        
                        const selectedOption = currentQuestionElement.querySelector(`.option.${selectedClass}`);
                        if (selectedOption) {
                            selectedOption.classList.add('selected');
                        }
                    }
                }
            }
            
            // Update navigation buttons
            updateNavigationButtons();
        }

        function updateNavigationButtons() {
            // Update navigation buttons for all questions
            for (let i = 1; i <= totalQuestions; i++) {
                const prevButton = document.getElementById(`prevButton${i}`);
                const nextButton = document.getElementById(`nextButton${i}`);
                const showSummaryButton = document.getElementById(`showSummaryButton${i}`);
                
                // Show Previous button on all questions except Question 1
                prevButton.style.display = i === 1 ? 'none' : 'block';
                
                // Show Next button if there's an answer for the current question
                nextButton.style.display = answers[i] !== undefined ? 'block' : 'none';
                
                // Show summary button only on the final question and if all required questions are answered
                const isFinalQuestion = (i === 10 && !answers[10]) || i === 11;
                const allRequiredAnswered = checkAllRequiredQuestionsAnswered();
                showSummaryButton.style.display = (isFinalQuestion && allRequiredAnswered) ? 'block' : 'none';
            }
        }

        function checkAllRequiredQuestionsAnswered() {
            // Check questions 1-10
            for (let i = 1; i <= 10; i++) {
                if (answers[i] === undefined) {
                    return false;
                }
            }
            
            // Check question 11 only if question 10 was answered Yes
            if (answers[10] === true && answers[11] === undefined) {
                return false;
            }
            
            return true;
        }

        function showPreviousQuestion() {
            if (currentQuestion > 1) {
                try {
                    currentQuestion--;
                    showQuestion(currentQuestion);
                } catch (error) {
                    console.error('Error navigating to previous question:', error);
                    // Fallback to first question if navigation fails
                    currentQuestion = 1;
                    showQuestion(1);
                }
            }
        }

        function showNextQuestion() {
            if (currentQuestion === 1 && !validateProjectInfo()) {
                return; // Don't proceed if validation fails
            }
            
            // Special handling for question 10
            if (currentQuestion === 10) {
                // If answer to question 10 is No, skip question 11
                if (!answers[10]) {
                    currentQuestion = 11;
                }
            }
            
            if (currentQuestion < totalQuestions) {
                try {
                    currentQuestion++;
                    showQuestion(currentQuestion);
                } catch (error) {
                    console.error('Error navigating to next question:', error);
                    // Stay on current question if navigation fails
                    showQuestion(currentQuestion);
                }
            }
        }

        function showSummary() {
            // Hide all questions and the result div
            for (let i = 1; i <= totalQuestions; i++) {
                document.getElementById(`question${i}`).classList.add('hidden');
            }
            document.getElementById('result').style.display = 'none';
            
            // Hide all category sections
            document.querySelectorAll('.category-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Show summary section
            const summaryDiv = document.getElementById('summary');
            const summaryContent = document.getElementById('summary-content');
            const finalResult = document.getElementById('final-result');
            const tableContent = document.getElementById('summary-table-content');
            
            let summaryHTML = '';
            let tableHTML = '';
            let isEligible = true;
            let hasWarnings = false;
            let hasUnknowns = false;
            let unknownQuestions = [];

            // Check for unknown answers
            for (let i = 1; i <= totalQuestions; i++) {
                if (answers[i] === 'unknown') {
                    hasUnknowns = true;
                    unknownQuestions.push(i);
                }
            }

            // Generate summary in numerical order
            for (let i = 1; i <= totalQuestions; i++) {
                if (i === 1) {
                    // Question 1 - AIO
                    const answer = answers[1];
                    const q1Class = answer === 'unknown' ? 'warning' : (answer ? 'danger' : 'success');
                    const q1Status = answer === 'unknown' ? '❓' : (answer ? '❌' : '✅');
                    const q1Message = answer === 'unknown' ? 'Information needed to complete assessment' :
                                    (answer ? 'DISQUALIFYING - All In One Required' : 'Application architecture supports separate database instance');
                    
                    summaryHTML += `
                        <div class="summary-item ${q1Class}">
                            <strong>Question 1 - Is this an all-in-one (AIO) application?</strong><br>
                            ${q1Status} ${q1Message}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>1</td>
                            <td>Is this an all-in-one (AIO) application?</td>
                            <td>${q1Status}</td>
                            <td>${q1Message}</td>
                        </tr>
                    `;
                    if (answer === true) {
                        isEligible = false;
                    }
                } else if (i === 2) {
                    // Question 2 - Vendor Install
                    const answer = answers[2];
                    const q2Class = answer === 'unknown' ? 'warning' : (answer ? 'danger' : 'success');
                    const q2Status = answer === 'unknown' ? '❓' : (answer ? '❌' : '✅');
                    const q2Message = answer === 'unknown' ? 'Information needed to complete assessment' :
                                    (answer ? 'DISQUALIFYING - Vendor-locked SQL Server installation' : 'Standard SQL Server installation');
                    
                    summaryHTML += `
                        <div class="summary-item ${q2Class}">
                            <strong>Question 2 - Is SQL Server tied to vendor installation?</strong><br>
                            ${q2Status} ${q2Message}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>2</td>
                            <td>Is SQL Server tied to vendor installation?</td>
                            <td>${q2Status}</td>
                            <td>${q2Message}</td>
                        </tr>
                    `;
                    if (answer === true) {
                        isEligible = false;
                    }
                } else if (i === 3) {
                    // Question 3 - Disk Usage
                    const answer = answers[3];
                    const q3Class = answer === 'unknown' ? 'warning' : (answer ? 'warning' : 'success');
                    const q3Status = answer === 'unknown' ? '❓' : (answer ? '⚠️' : '✅');
                    const q3Message = answer === 'unknown' ? 'Information needed to complete assessment' :
                                    (answer ? '⚠️ Large database size (>100GB) - requires evaluation' : '✅ Database size is within acceptable limits');
                    
                    summaryHTML += `
                        <div class="summary-item ${q3Class}">
                            <strong>Question 3 - Will database size exceed 100GB?</strong><br>
                            ${q3Status} ${q3Message}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>3</td>
                            <td>Will database size exceed 100GB?</td>
                            <td>${q3Status}</td>
                            <td>${q3Message}</td>
                        </tr>
                    `;
                    if (answer === true) hasWarnings = true;
                } else if (i === 4) {
                    // Question 4 - Database Renaming
                    const answer = answers[4];
                    const q4Class = answer === 'unknown' ? 'warning' : (answer ? 'success' : 'warning');
                    const q4Status = answer === 'unknown' ? '❓' : (answer ? '✅' : '⚠️');
                    const q4Message = answer === 'unknown' ? 'Information needed to complete assessment' :
                                    (answer ? '✅ Database can be renamed as needed' : '⚠️ Database naming restrictions present - requires evaluation');
                    
                    summaryHTML += `
                        <div class="summary-item ${q4Class}">
                            <strong>Question 4 - Can databases be renamed?</strong><br>
                            ${q4Status} ${q4Message}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>4</td>
                            <td>Can databases be renamed?</td>
                            <td>${q4Status}</td>
                            <td>${q4Message}</td>
                        </tr>
                    `;
                    if (answer === false) hasWarnings = true;
                } else if (i === 5) {
                    // Question 5 - Latency
                    const answer = answers[5];
                    const latencyClass = answer ? 
                        (answer.isDisqualifying ? 'danger' : 
                        (answer.level === 'unknown' || answer.level === 'low' ? 'warning' : 'success')) : '';
                    let latencyMessage = 'Unanswered';
                    let latencyDetails = 'Unanswered';
                    
                    if (answer) {
                        switch(answer.level) {
                            case 'very-low':
                                latencyMessage = '❌ IMMEDIATE DISQUALIFICATION - Requires very low latency (1-10ms)';
                                latencyDetails = 'Requires very low latency (1-10ms)';
                                break;
                            case 'unknown':
                                latencyMessage = '⚠️ Latency requirements need to be determined';
                                latencyDetails = 'Latency requirements need to be determined';
                                break;
                            case 'low':
                                latencyMessage = '⚠️ Low latency requirements (10-50ms) - requires evaluation';
                                latencyDetails = 'Low latency requirements (10-50ms) - requires evaluation';
                                break;
                            case 'moderate':
                                latencyMessage = '✅ Moderate latency requirements (50-100ms) - acceptable';
                                latencyDetails = 'Moderate latency requirements (50-100ms)';
                                break;
                            case 'high':
                                latencyMessage = '✅ High latency requirements (100-500ms) - acceptable';
                                latencyDetails = 'High latency requirements (100-500ms)';
                                break;
                            case 'very-high':
                                latencyMessage = '✅ Very high latency requirements (>500ms) - acceptable';
                                latencyDetails = 'Very high latency requirements (>500ms)';
                                break;
                        }
                    }

                    summaryHTML += `
                        <div class="summary-item ${latencyClass}">
                            <strong>Question 5 - Required network latency?</strong><br>
                            ${latencyMessage}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>5</td>
                            <td>Required network latency?</td>
                            <td>${answer ? (answer.isDisqualifying ? '❌' : (answer.level === 'unknown' || answer.level === 'low' ? '⚠️' : '✅')) : '-'}</td>
                            <td>${latencyDetails}</td>
                        </tr>
                    `;

                    if (answer) {
                        if (answer.isDisqualifying) {
                            isEligible = false;
                        } else if (answer.level === 'unknown' || answer.level === 'low') {
                            hasWarnings = true;
                        }
                    }
                } else if (i === 6) {
                    // Question 6 - Chattiness
                    const answer = answers[6];
                    const chattinessClass = answer ? (answer.level === 'high' ? 'warning' : 'success') : '';
                    let chattinessMessage = 'Unanswered';
                    let chattinessDetails = 'Unanswered';
                    
                    if (answer) {
                        switch(answer.level) {
                            case 'low':
                                chattinessMessage = '✅ Low database interaction frequency - well suited for multitenancy';
                                chattinessDetails = 'Low database interaction frequency';
                                break;
                            case 'moderate':
                                chattinessMessage = '✅ Moderate database interaction frequency - acceptable for multitenancy';
                                chattinessDetails = 'Moderate database interaction frequency';
                                break;
                            case 'high':
                                chattinessMessage = '⚠️ High database interaction frequency - requires detailed analysis';
                                chattinessDetails = 'High database interaction frequency - requires detailed analysis';
                                break;
                        }
                    }

                    summaryHTML += `
                        <div class="summary-item ${chattinessClass}">
                            <strong>Question 6 - Application chattiness level?</strong><br>
                            ${chattinessMessage}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>6</td>
                            <td>Application chattiness level?</td>
                            <td>${answer ? (answer.level === 'high' ? '⚠️' : '✅') : '-'}</td>
                            <td>${chattinessDetails}</td>
                        </tr>
                    `;

                    if (answer && answer.level === 'high') {
                        hasWarnings = true;
                    }
                } else if (i === 7) {
                    // Question 7 - Time Zone
                    const answer = answers[7];
                    const q7Class = answer === 'unknown' ? 'warning' : (answer ? 'success' : 'warning');
                    const q7Status = answer === 'unknown' ? '❓' : (answer ? '✅' : '⚠️');
                    const q7Message = answer === 'unknown' ? 'Information needed to complete assessment' :
                                    (answer ? '✅ Flexible time zone configuration' : '⚠️ Specific time zone requirement - requires evaluation');
                    
                    summaryHTML += `
                        <div class="summary-item ${q7Class}">
                            <strong>Question 7 - Can database be in different time zone?</strong><br>
                            ${q7Status} ${q7Message}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>7</td>
                            <td>Can database be in different time zone?</td>
                            <td>${q7Status}</td>
                            <td>${q7Message}</td>
                        </tr>
                    `;
                    if (answer === false) hasWarnings = true;
                } else if (i === 8) {
                    // Question 8 - Server Admin Privileges
                    const answer = answers[8];
                    const q8Class = answer === 'unknown' ? 'warning' : (answer ? 'warning' : 'success');
                    const q8Status = answer === 'unknown' ? '❓' : (answer ? '⚠️' : '✅');
                    const q8Message = answer === 'unknown' ? 'Information needed to complete assessment' :
                                    (answer ? '⚠️ Administrative privileges on the server are required' : '✅ No administrative privileges on the server are required');
                    
                    summaryHTML += `
                        <div class="summary-item ${q8Class}">
                            <strong>Question 8 - Are administrative privileges on the server required?</strong><br>
                            ${q8Status} ${q8Message}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>8</td>
                            <td>Are administrative privileges on the server required?</td>
                            <td>${q8Status}</td>
                            <td>${q8Message}</td>
                        </tr>
                    `;
                    if (answer === true) hasWarnings = true;
                } else if (i === 9) {
                    // Question 9 - SQL Server Admin Privileges
                    const answer = answers[9];
                    const q9Class = answer === 'unknown' ? 'warning' : (answer ? 'danger' : 'success');
                    const q9Status = answer === 'unknown' ? '❓' : (answer ? '❌' : '✅');
                    const q9Message = answer === 'unknown' ? 'Information needed to complete assessment' :
                                    (answer ? '❌ DISQUALIFYING - Permanent administrative privileges required' : '✅ No permanent administrative privileges required');
                    
                    summaryHTML += `
                        <div class="summary-item ${q9Class}">
                            <strong>Question 9 - Are permanent administrative privileges on the SQL Server instance required?</strong><br>
                            ${q9Status} ${q9Message}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>9</td>
                            <td>Are permanent administrative privileges on the SQL Server instance required?</td>
                            <td>${q9Status}</td>
                            <td>${q9Message}</td>
                        </tr>
                    `;
                    if (answer === true) {
                        isEligible = false;
                    }
                } else if (i === 10) {
                    // Question 10 - SSRS, SSIS, SSAS
                    const answer = answers[10];
                    const q10Class = answer ? 'warning' : 'success';
                    const q10Status = answer ? '⚠️' : '✅';
                    const q10Message = answer ? '⚠️ Additional components (SSRS, SSIS, SSAS) required' : '✅ No additional components required';
                    
                    summaryHTML += `
                        <div class="summary-item ${q10Class}">
                            <strong>Question 10 - Are any of the following components required for this application?</strong><br>
                            ${q10Status} ${q10Message}
                        </div>
                    `;
                    tableHTML += `
                        <tr>
                            <td>10</td>
                            <td>Are any of the following components required for this application?</td>
                            <td>${q10Status}</td>
                            <td>${q10Message}</td>
                        </tr>
                    `;
                    if (answer === true) hasWarnings = true;
                } else if (i === 11) {
                    if (answers[10] === true) {
                        const answer = answers[11];
                        const q11Class = answer ? 'warning' : 'success';
                        const q11Status = answer ? '⚠️' : '✅';
                        const q11Message = answer ? '⚠️ Components must be co-located with SQL Server' : '✅ Components can be on separate servers';
                        
                        summaryHTML += `
                            <div class="summary-item ${q11Class}">
                                <strong>Question 11 - Must non-engine components be on same server?</strong><br>
                                ${q11Status} ${q11Message}
                            </div>
                        `;
                        tableHTML += `
                            <tr>
                                <td>11</td>
                                <td>Must non-engine components be on same server?</td>
                                <td>${q11Status}</td>
                                <td>${q11Message}</td>
                            </tr>
                        `;
                        if (answer === true) hasWarnings = true;
                    }
                }
            }
            
            summaryContent.innerHTML = summaryHTML;
            tableContent.innerHTML = tableHTML;
            
            // Final eligibility conclusion
            let conclusionClass = 'success';
            let conclusionMessage = '';

            if (unknownQuestions.length > 0) {
                conclusionClass = 'warning';
                conclusionMessage = `<strong>CONCLUSION:</strong> Assessment cannot be completed. The following questions need answers: ${unknownQuestions.join(', ')}`;
            } else if (!isEligible) {
                conclusionClass = 'danger';
                conclusionMessage = '<strong>CONCLUSION:</strong> Application is NOT eligible for multitenancy';
            } else if (hasWarnings) {
                conclusionClass = 'warning';
                conclusionMessage = '<strong>CONCLUSION:</strong> Application requires further evaluation for multitenancy';
            } else {
                conclusionMessage = '<strong>CONCLUSION:</strong> Application is eligible for multitenancy';
            }

            summaryHTML += `
                <div class="summary-item ${conclusionClass}">
                    ${conclusionMessage}
                </div>
            `;
            
            summaryDiv.style.display = 'block';
            
            // Update navigation
            document.getElementById(`nextButton${currentQuestion}`).style.display = 'none';
            document.getElementById(`showSummaryButton${currentQuestion}`).style.display = 'none';
            
            // Update question select options
            const questionSelect = document.getElementById('questionSelect');
            questionSelect.innerHTML = '<option value="">Go to question...</option>';
            
            for (let i = 1; i <= totalQuestions; i++) {
                // Skip question 11 if question 10 was answered No
                if (i === 11 && !answers[10]) continue;
                
                const questionElement = document.getElementById(`question${i}`);
                const questionText = questionElement.querySelector('.question').textContent.trim();
                const shortQuestionText = questionText.length > 50 ? 
                    questionText.substring(0, 50) + '...' : 
                    questionText;
                
                questionSelect.innerHTML += `
                    <option value="${i}">Question ${i}: ${shortQuestionText}</option>
                `;
            }
            
            // Add event listener for question selection
            questionSelect.addEventListener('change', function() {
                const selectedQuestion = parseInt(this.value);
                if (selectedQuestion) {
                    currentQuestion = selectedQuestion;
                    showQuestion(selectedQuestion);
                    this.value = ''; // Reset dropdown
                }
            });
        }

        function switchSummaryView(view) {
            // Update tab buttons
            document.querySelectorAll('.summary-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update views
            document.querySelectorAll('.summary-view').forEach(v => {
                v.classList.remove('active');
            });
            document.getElementById(`${view}-view`).classList.add('active');

            // If switching to spreadsheet view, update the spreadsheet content
            if (view === 'spreadsheet') {
                updateSpreadsheetView();
            }
        }

        function updateSpreadsheetView() {
            const spreadsheetContent = document.getElementById('spreadsheet-content');
            let spreadsheetHTML = '';

            // Generate spreadsheet rows for each question
            for (let i = 1; i <= totalQuestions; i++) {
                // Skip question 11 if question 10 was answered No
                if (i === 11 && !answers[10]) continue;

                const category = questionToCategory[i];
                const questionElement = document.getElementById(`question${i}`);
                const questionText = questionElement.querySelector('.question').textContent.trim();
                let answer = '';
                let status = '';
                let details = '';

                // Handle different question types
                if (i === 5) { // Latency question
                    if (answers[i]) {
                        answer = answers[i].level;
                        status = answers[i].isDisqualifying ? '❌' : 
                               (answers[i].level === 'unknown' ? '❓' : 
                               answers[i].level === 'low' ? '⚠️' : '✅');
                        details = getLatencyDetails(answers[i].level);
                    }
                } else if (i === 6) { // Chattiness question
                    if (answers[i]) {
                        answer = answers[i].level;
                        status = answers[i].level === 'unknown' ? '❓' :
                                answers[i].level === 'high' ? '⚠️' : '✅';
                        details = getChattinessDetails(answers[i].level);
                    }
                } else {
                    if (answers[i] !== undefined) {
                        answer = answers[i] === 'unknown' ? 'Unknown' : 
                                answers[i] ? 'Yes' : 'No';
                        status = getQuestionStatus(i, answers[i]);
                        details = getQuestionDetails(i, answers[i]);
                    }
                }

                spreadsheetHTML += `
                    <tr>
                        <td>${i}</td>
                        <td>${getCategoryName(category)}</td>
                        <td>${questionText}</td>
                        <td>${answer}</td>
                        <td>${status}</td>
                        <td>${details}</td>
                    </tr>
                `;
            }

            spreadsheetContent.innerHTML = spreadsheetHTML;
        }

        function getCategoryName(category) {
            const categoryMap = {
                'architecture': 'Architecture Requirements',
                'storage': 'Storage Requirements',
                'network': 'Network & Performance Requirements',
                'configuration': 'Configuration Requirements',
                'security': 'Security Requirements',
                'components': 'Components Requirements'
            };
            return categoryMap[category] || category;
        }

        function getQuestionStatus(questionNumber, answer) {
            if (answer === 'unknown') {
                return '❓';
            }
            if (questionNumber === 1 || questionNumber === 2 || questionNumber === 9) {
                return answer ? '❌' : '✅';
            } else if ([3, 4, 7, 8, 10, 11].includes(questionNumber)) {
                return answer ? '⚠️' : '✅';
            }
            return '';
        }

        function getQuestionDetails(questionNumber, answer) {
            if (answer === 'unknown') {
                return 'Information needed to complete assessment';
            }
            const detailsMap = {
                1: answer ? 'All In One Required' : 'Application architecture supports separate database instance',
                2: answer ? 'Vendor-locked SQL Server installation' : 'Standard SQL Server installation',
                3: answer ? 'Large database size (>100GB) - requires evaluation' : 'Database size is within acceptable limits',
                4: answer ? 'Database can be renamed as needed' : 'Database naming restrictions present - requires evaluation',
                7: answer ? 'Flexible time zone configuration' : 'Specific time zone requirement - requires evaluation',
                8: answer ? 'Administrative privileges on the server are required' : 'No administrative privileges on the server are required',
                9: answer ? 'Permanent administrative privileges required' : 'No permanent administrative privileges required',
                10: answer ? 'Additional components required' : 'No additional components required',
                11: answer ? 'Components must be co-located' : 'Components can be separated'
            };
            return detailsMap[questionNumber] || '';
        }

        function handleLatencyAnswer(latencyLevel) {
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';

            answers[5] = {
                level: latencyLevel,
                isDisqualifying: latencyLevel === 'very-low'
            };

            if (latencyLevel === 'very-low') {
                resultDiv.className = 'result not-eligible';
                resultDiv.innerHTML = `
                    <strong>DISQUALIFYING</strong><br>
                    Very low latency requirement (1-10ms) is not compatible with a multitenant environment. 
                    This application requires dedicated resources to maintain such low latency. Continuing with assessment for complete evaluation.
                `;
                document.getElementById('nextButton5').style.display = 'block';
            } else if (latencyLevel === 'low') {
                resultDiv.className = 'result warning';
                resultDiv.innerHTML = `
                    <strong>Further Evaluation Needed</strong><br>
                    Low latency requirements (10-50ms) may need additional analysis to ensure compatibility with multitenant environment capabilities.
                `;
                document.getElementById('nextButton5').style.display = 'block';
            } else {
                if (latencyLevel === 'unknown') {
                    resultDiv.className = 'result warning';
                    resultDiv.innerHTML = `
                        <strong>Further Evaluation Needed</strong><br>
                        Latency requirements need to be determined and evaluated against the multitenant environment capabilities.
                    `;
                } else {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = `
                        <strong>Compatible with Multitenancy</strong><br>
                        The latency requirement is within acceptable range for a multitenant environment.
                    `;
                }
                document.getElementById('nextButton5').style.display = 'block';
            }
            
            updateNavigationButtons();
        }

        function handleChattinessAnswer(chattinessLevel) {
            const resultDiv = document.getElementById('result');
            
            // Hide result if no selection
            if (!chattinessLevel) {
                resultDiv.style.display = 'none';
                return;
            }
            
            // Only proceed if a selection has been made
            resultDiv.style.display = 'block';
            answers[6] = {
                level: chattinessLevel
            };

            if (chattinessLevel === 'high') {
                resultDiv.className = 'result warning';
                resultDiv.innerHTML = `
                    <strong>Further Evaluation Needed</strong><br>
                    High database interaction frequency may impact performance in a multitenant environment. Additional analysis of the specific interaction patterns and resource requirements is needed.
                `;
            } else {
                resultDiv.className = 'result eligible';
                resultDiv.innerHTML = `
                    <strong>Compatible with Multitenancy</strong><br>
                    ${chattinessLevel === 'moderate' ? 'Moderate' : 'Low'} database interaction frequency is acceptable for a multitenant environment.
                `;
            }
            
            // Show the Next button
            document.getElementById('nextButton6').style.display = 'block';
            updateNavigationButtons();
        }

        function startOver() {
            // Reset all answers
            for (let key in answers) {
                delete answers[key];
            }
            
            // Reset current question to 1
            currentQuestion = 1;
            
            // Clear all selected options
            document.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Reset dropdowns
            document.getElementById('latencySelect').value = '';
            document.getElementById('chattinessSelect').value = '';
            
            // Clear project info fields
            document.getElementById('projectId').value = '';
            document.getElementById('application').value = '';
            
            // Show first question
            showQuestion(1);
        }

        function showPreviousFromSummary() {
            // Return to the last question
            currentQuestion = totalQuestions;
            showQuestion(currentQuestion);
            
            // Force update navigation buttons to show Previous button
            const prevButton = document.getElementById(`prevButton${currentQuestion}`);
            if (prevButton) {
                prevButton.style.display = 'block';
            }
        }

        function validateProjectInfo() {
            // Always return true since fields are no longer required
            return true;
        }

        function handleAnswer(questionNumber, answer) {
            // Store the answer
            answers[questionNumber] = answer;
            
            // Clear all selected states in the current question container
            const currentQuestionElement = document.getElementById(`question${questionNumber}`);
            currentQuestionElement.querySelectorAll('.option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Add selected class to the clicked option
            const selectedOption = event.target;
            selectedOption.classList.add('selected');
            
            // Show result message
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            
            // Handle different answer types
            if (answer === 'unknown') {
                resultDiv.className = 'result warning';
                resultDiv.innerHTML = '<strong>Information Needed</strong><br>This question requires an answer to complete the assessment.';
            } else if (questionNumber === 1) {
                // Question 1 - AIO
                if (answer) {
                    resultDiv.className = 'result not-eligible';
                    resultDiv.innerHTML = `
                        <strong>DISQUALIFYING</strong><br>
                        All-in-one (AIO) applications are not compatible with multitenancy. 
                        This application requires dedicated resources. Continuing with assessment for complete evaluation.
                    `;
                } else {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>Application architecture supports separate database instance.';
                }
            } else if (questionNumber === 2) {
                // Question 2 - Vendor Install
                if (answer) {
                    resultDiv.className = 'result not-eligible';
                    resultDiv.innerHTML = `
                        <strong>DISQUALIFYING</strong><br>
                        Vendor-locked SQL Server installations are not compatible with multitenancy. 
                        This application requires dedicated resources. Continuing with assessment for complete evaluation.
                    `;
                } else {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>Standard SQL Server installation.';
                }
            } else if (questionNumber === 3) {
                // Question 3 - Disk Usage
                if (answer) {
                    resultDiv.className = 'result warning';
                    resultDiv.innerHTML = '<strong>Further Evaluation Needed</strong><br>Large database size (>100GB) may require additional analysis.';
                } else {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>Database size is within acceptable limits.';
                }
            } else if (questionNumber === 4) {
                // Question 4 - Database Renaming
                if (answer) {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>Database can be renamed as needed.';
                } else {
                    resultDiv.className = 'result warning';
                    resultDiv.innerHTML = '<strong>Further Evaluation Needed</strong><br>Database naming restrictions present - requires evaluation.';
                }
            } else if (questionNumber === 7) {
                // Question 7 - Time Zone
                if (answer) {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>Flexible time zone configuration.';
                } else {
                    resultDiv.className = 'result warning';
                    resultDiv.innerHTML = '<strong>Further Evaluation Needed</strong><br>Specific time zone requirement - requires evaluation.';
                }
            } else if (questionNumber === 8) {
                // Question 8 - Server Admin Privileges
                if (answer) {
                    resultDiv.className = 'result warning';
                    resultDiv.innerHTML = '<strong>Further Evaluation Needed</strong><br>Administrative privileges on the server are required.';
                } else {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>No administrative privileges on the server are required.';
                }
            } else if (questionNumber === 9) {
                // Question 9 - SQL Server Admin Privileges
                if (answer) {
                    resultDiv.className = 'result not-eligible';
                    resultDiv.innerHTML = `
                        <strong>DISQUALIFYING</strong><br>
                        Permanent administrative privileges are not compatible with multitenancy. 
                        This application requires dedicated resources. Continuing with assessment for complete evaluation.
                    `;
                } else {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>No permanent administrative privileges required.';
                }
            } else if (questionNumber === 10) {
                // Question 10 - SSRS, SSIS, SSAS
                if (answer) {
                    resultDiv.className = 'result warning';
                    resultDiv.innerHTML = '<strong>Further Evaluation Needed</strong><br>Additional components (SSRS, SSIS, SSAS) required.';
                    // Show Next button only if the answer is Yes
                    document.getElementById(`nextButton${questionNumber}`).style.display = 'block';
                } else {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>No additional components required.';
                    // Hide Next button for No or Unknown answers
                    document.getElementById(`nextButton${questionNumber}`).style.display = 'none';
                    // Show Summary button since this is the end of the assessment
                    document.getElementById(`showSummaryButton${questionNumber}`).style.display = 'block';
                }
            } else if (questionNumber === 11) {
                // Question 11 - Component Location
                if (answer) {
                    resultDiv.className = 'result warning';
                    resultDiv.innerHTML = '<strong>Further Evaluation Needed</strong><br>Components must be co-located with SQL Server.';
                } else {
                    resultDiv.className = 'result eligible';
                    resultDiv.innerHTML = '<strong>Compatible with Multitenancy</strong><br>Components can be on separate servers.';
                }
            }
            
            // Show the Next button
            document.getElementById(`nextButton${questionNumber}`).style.display = 'block';
            updateNavigationButtons();
        }

        // Optimize event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Add input event listeners for real-time validation
            DOM.projectId.addEventListener('input', function() {
                this.classList.remove('error');
                DOM.projectIdError.style.display = 'none';
            });

            DOM.application.addEventListener('input', function() {
                this.classList.remove('error');
                DOM.applicationError.style.display = 'none';
            });

            // Add keyboard navigation
            document.addEventListener('keydown', function(event) {
                if (event.key === 'ArrowLeft') {
                    showPreviousQuestion();
                } else if (event.key === 'ArrowRight') {
                    showNextQuestion();
                } else if (event.key === 'Enter' || event.key === ' ') {
                    const activeElement = document.activeElement;
                    if (activeElement.classList.contains('option')) {
                        const isYes = activeElement.classList.contains('yes');
                        const questionNumber = parseInt(activeElement.closest('.question-container').id.replace('question', ''));
                        handleAnswer(questionNumber, isYes);
                    }
                }
            });

            // Initialize the first question
            showQuestion(1);
        });
    </script>
</body>
</html> 